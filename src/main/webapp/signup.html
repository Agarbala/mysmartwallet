<html>
    <head>
        <title>Sign Up</title>

        <link rel="stylesheet" type="text/css" href="/css/style.css">
      
    </head>
    <body>
        <form id="signupForm" action="signupProcess" method="post">
            <table>
                <tr>
                    <td>
                        <label for="username">Username:</label>
                    </td>
                    <td>
                        <input type="text" id="username" name="username" required><br>
                        <div id="usernameAvailability"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="password">Password:</label>
                    </td>
                    <td>
                        <input type="password" id="password" name="password" required><br>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="nome">Nome:</label>
                    </td>
                    <td>
                        <input type="text" id="nome" name="nome" required><br>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="cognome">Cognome:</label>
                    </td>
                    <td>
                        <input type="text" id="cognome" name="cognome" required><br>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="datadinascita">Data di nascita:</label>
                    </td>
                    <td>
                        <input type="date" id="datadinascita" name="datadinascita" required><br>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="submit" id="submit" value="Registrati" onClick="" >
                    </td>
                 </tr>
            </table>
        </form>
        
        
        
         <!-- Inclusione di jQuery -->
   		 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   		 <!-- Codice jQuery -->
	    <script>
	   
	    $(document).ready(function() {
	        var isUsernameDisponibile = false;  // variabile di controllo
	        
	        $('#username').on('blur', function() {
	            var username = $(this).val();
	            $.ajax({
	                url: '/isUsernameDisponibile',
	                type: 'POST',
	                data: {username: username},
	                success: function(response) {
	                    if (response) {
	                        isUsernameDisponibile = true;  
	                    } else {
	                        
	                        isUsernameDisponibile = false;   
	                    }
	                }
	            });
	        });
	        
	        $('#signupForm').on('submit', function(event) {
	            if (!isUsernameDisponibile) {  
	                //alert("Usa un altro username!");
	                $('#usernameAvailability').text('Username non disponibile');
                    //$('#submit').hide(); -> potrebbe confondere l'utente
                    $('#username').css('border-color', 'red');
	                event.preventDefault();  // impedisce l'invio
	            }
	        });

	    });

	    </script>
    </body>
</html>